{
  "unpublishedCollection": {
    "name": "Data",
    "pageId": "Travel Dashboard",
    "pluginId": "js-plugin",
    "pluginType": "JS",
    "actions": [],
    "archivedActions": [],
    "body": "export default {\n\tCurrentUserId: () => { return 1 },\n\tUpdateAll: async () => {\n\t\tawait GetAllUsers.run();\n\t\tawait GetAllAverages.run();\n\t},\n\tGetUsersAverages: () => {\n\t\tlet users = GetAllUsers.data;\n\t\tlet averages = GetAllAverages.data;\n\t\treturn users.map(u => {\n\t\t\tu.Averages = averages.filter(a => a.UserId === u.Id);\n\t\t\treturn u;\n\t\t});\n\t},\n\tGetUser: (id) => { return Data.GetUsersAverages().find(u => u.Id === id) },\n\tGetCurrentUser: () => { return Data.GetUser(Data.CurrentUserId()); },\n\tGetUsersOfCountry: (country) => {\n\t\treturn Data.GetUsersAverages().filter(u => u.Country === country);\n\t},\n\tGetCountries: () => {\n\t\treturn GetAllUsers.data.map(u => u.Country).filter((v, i, s) => s.indexOf(v) == i);\n\t},\n\tGetCurrentUserAverageSpending: () => {\n\t\tlet sum = 0;\n\t\tData.GetCurrentUser().Averages.forEach(a => sum += a.Sum);\n\t\treturn Math.ceil(sum / Data.GetCurrentUser().Averages.length);\n\t},\n\tGetAverageSpendingInCountry: (country) => {\n\t\tlet averages = Data.GetUsersOfCountry(country).map(u => {\n\t\t\tlet sum = 0, n = 0;\n\t\t\tu.Averages.forEach(a => {\n\t\t\t\tif(a.Sum !== 0) {\n\t\t\t\t\tsum += a.Sum;\n\t\t\t\t\tn++;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn sum / n;\n\t\t}).filter(s => s).sort().reverse();\n\t\tlet sum = 0;\n\t\taverages.forEach(a => sum += a);\n\t\treturn Math.ceil(sum / averages.length);\n\t},\n\tGetCategories: () => {\n\t\treturn Data.GetCurrentUser().Averages.map(o => Object.keys(o))[0].filter(c => c !== \"Id\" && c !== \"UserId\" && c !== \"rowIndex\" && c !== \"Sum\" && c !== \"Month\");\n\t},\n\tGetAverageSpendingCategoriesInCountry: (country) => {\n\t\tlet averages = Data.GetUsersOfCountry(\"Portugal\").map(u => {\n\t\t\tfor(let c in Data.GetCategories()) {\n\t\t\t\tlet sum = 0;\n\t\t\t\tu.Averages.forEach(a => sum += a[c]);\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\treturn averages;\n\t},\n\tGetTopSpendingCategories: (country) => {\n\t\tlet averages = Data.GetAverageSpendingCategoriesInCountry(\"Portugal\")\n\t},\n}",
    "variables": []
  },
  "id": "Travel Dashboard_Data",
  "deleted": false,
  "gitSyncId": "6353c0894b1a8d4291236e5b_6354075bdc264920d5e26eeb"
}